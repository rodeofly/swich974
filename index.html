<head>
    <meta charset="UTF-8">
    <script src="//cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>

    <script src="js/Keys.js"></script>
    
    <script src="js/core/BaseGameScene.js"></script>
    <script src="js/core/BootScene.js"></script>
    <script src="js/core/MenuScene.js"></script>
</head>
<body>
    <div id="game-container"></div>

    <script>
        // --- CHARGEUR DYNAMIQUE ---
        (function() {
            let loadedCount = 0;
            // On vérifie que le manifeste existe pour éviter le crash
            if (typeof GAMES_MANIFEST === 'undefined') {
                console.error("ERREUR CRITIQUE : GAMES_MANIFEST introuvable dans Keys.js");
                return;
            }

            const totalScripts = GAMES_MANIFEST.length;

            function checkAllLoaded() {
                loadedCount++;
                if (loadedCount === totalScripts) {
                    // ATTENTION : main.js est maintenant dans js/core/
                    const mainScript = document.createElement('script');
                    mainScript.src = 'js/core/main.js'; 
                    document.body.appendChild(mainScript);
                }
            }

            GAMES_MANIFEST.forEach(game => {
                const script = document.createElement('script');
                script.src = game.path; // Le chemin viendra du Keys.js mis à jour
                script.onload = checkAllLoaded;
                script.onerror = () => console.error(`Erreur de chargement : ${game.path}`);
                document.head.appendChild(script);
            });
        })();
    </script>
</body>